; Find the Hardy-Ramanujan number (many times)
(let ([seen (new-array 6750 0)])
  (letrec ([checka
             (lambda (a)
               (letrec ([checkb 
                          (lambda (b)
                            (let ([a3 (* (* a a) a)])
                              (let ([b3 (* (* b b) b)])
                                (let ([sum (+ a3 b3)])
                                  (if (= 1 (aref seen sum))
                                    (print sum)
                                    (begin (aset seen sum 1)
                                           (if (= b 15)
                                             (checka (+ a 1))
                                             (checkb (+ b 1)))))))))])
                 (checkb (+ a 1))))])
    (letrec ([reset (lambda (i) (if (= i 0) 0 (begin (aset seen (- i 1) 0) (reset (- i 1)))))])
    (letrec ([again (lambda (i) (if (= i 0) 0 (begin (reset (alen seen)) (begin (checka 0) (again (- i 1))))))])
      (again 2000)))))
